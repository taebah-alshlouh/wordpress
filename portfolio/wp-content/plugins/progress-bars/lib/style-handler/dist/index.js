!function(){"use strict";var t=window.wp.data,e=window.lodash,o=window.wp.blocks;function n(t,e){var o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=function(t,e){if(t){if("string"==typeof t)return i(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?i(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){o&&(t=o);var n=0,r=function(){};return{s:r,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,a=!1;return{s:function(){o=o.call(t)},n:function(){var t=o.next();return s=t.done,t},e:function(t){a=!0,c=t},f:function(){try{s||null==o.return||o.return()}finally{if(a)throw c}}}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}!function(){var i=eb_style_handler.editor_type,r=function(t,e){return t&&e?t+"//"+e:null},c=function(){},s=function(){},a={};"edit-site"===i?a=(0,t.select)("core/edit-site"):"edit-post"===i&&(a=(0,t.select)("core/edit-post")),s=a.__experimentalGetPreviewDeviceType,window.ebEditCurrentPreviewOption=s();var l=(0,t.select)("core/editor"),u=l.isSavingPost,d=void 0===u?c:u,v=l.isAutosavingPost,f=void 0===v?c:v,b=l.isSavingNonPostEntityChanges,p=void 0===b?c:b,y=function(){var s=(0,t.select)("core").getEditedEntityRecord,a=void 0===s?c:s,l=(0,t.select)("core/block-editor").getBlocks,u=void 0===l?c:l,d=(0,t.select)("core/editor").getCurrentPostId,v=(void 0===d?c:d)(),f=u(),b={};!function t(i){var c,s=n(i);try{for(s.s();!(c=s.n()).done;){var l=c.value,u=l.attributes,d=u.blockMeta,v=u.blockRoot,f=u.blockId,p=l.innerBlocks;if((0,e.isFunction)(o.isReusableBlock)&&(0,o.isReusableBlock)(l)){var y,k=a("postType","wp_block",l.attributes.ref)||{},w=n(k.content?(0,o.parse)((0,e.isFunction)(k.content)?k.content(k):k.content):[]);try{for(w.s();!(y=w.n()).done;){var h=y.value,g=h.attributes,_=g.blockMeta,m=g.blockRoot,P=g.blockId,B=h.innerBlocks;_&&"essential_block"===m&&(b[P]=_),B.length>0&&t(B)}}catch(t){w.e(t)}finally{w.f()}}else if((0,e.isFunction)(o.isTemplatePart)&&(0,o.isTemplatePart)(l)){var T=l.attributes,E=T.theme,S=T.slug,A=a("postType","wp_template_part",r(E,S))||{},O=A.blocks,R=void 0===O?[]:O,I=A.innerBlocks,j=void 0===I?[]:I;t(R),t(j)}else d&&"essential_block"===v&&(b[f]=d);p.length>0&&t(p)}}catch(t){s.e(t)}finally{s.f()}}(f);var p=JSON.stringify(b);jQuery.ajax({type:"POST",url:ajaxurl,data:{data:p,id:v,editorType:i,action:"eb_write_block_css",nonce:eb_style_handler.sth_nonce},error:function(t){console.log(t)}})},k=function(){if(window.ebEditCurrentPreviewOption!==s()){var e=s();window.ebEditCurrentPreviewOption=e;var o=lodash.isFunction,i=wp.blocks,a=i.parse,l=void 0===a?c:a,u=i.isReusableBlock,d=void 0===u?c:u,v=i.isTemplatePart,f=void 0===v?c:v,b=(0,t.select)("core").getEditedEntityRecord,p=void 0===b?c:b,y=(0,t.select)("core/block-editor").getBlocks,k=void 0===y?c:y,w=(0,t.dispatch)("core/block-editor").updateBlockAttributes,h=void 0===w?c:w,g=k(),_=[];!function t(e){var i,c=n(e);try{for(c.s();!(i=c.n()).done;){var s=i.value,a=s.clientId,u=s.innerBlocks,v=void 0===u?[]:u,b=s.attributes;if("essential_block"===(void 0===b?{}:b).blockRoot)_.push(a);else if(o(d)&&d(s)){var y=p("postType","wp_block",s.attributes.ref)||{};t(y.content?l(o(y.content)?y.content(y):y.content):[])}else if(o(f)&&f(s)){var k=s.attributes,w=k.theme,h=k.slug,g=p("postType","wp_template_part",r(w,h))||{},m=g.blocks,P=void 0===m?[]:m,B=g.innerBlocks,T=void 0===B?[]:B;t(P),t(T)}v.length>0&&t(v)}}catch(t){c.e(t)}finally{c.f()}}(g),h(_,{resOption:e})}};"edit-site"===i?(0,t.subscribe)((function(){p()&&y(),k()})):"edit-post"===i&&(0,t.subscribe)((function(){d()&&!f()&&y(),k()}))}()}();